### 第二轮迭代-- 预约界面更新内容



#### 1. 增加了预约备选项，增加预约的稳定性，同时处理函数变得复杂了

增加了预约备选项后，需要增加复杂的设置，同时要处理多种情况

> 1 .  在不是每天晚上10：45前，预约第二天的座位，需要提交到后台，
>
> 交给后台处理生成预约任务等待执行
>
> 2 .  在其他时间，包括10：45之前预约今天的座位，10：45后预约第二天的座位，都是直接本地直接发起，不通过服务器的预约。
>
> 3 .  在考虑备选的时候，要求实现短路，只有在第一个没选上才选第二个，后台也一样。

#### 2. 因此需要修改前端同后台之间的接口

需要增加关于备选项的数据

需要修改后台的服务器接口，

同时本地的POST方法增加对应的数据项

#### 3. 修改了预约座位的数据提交



#### 4. 修改预约座位的函数处理

主要是增加了预约的备选处理，函数规模复杂化，同时分离重构了原本的函数，拆分成两个函数。

避免一个js函数规模过大，可读性差的问题.



#### 5.增加了页面的下拉刷新功能

能够让用户自己刷新数据保证数据的及时有效性



#### 6.对刷新和座位提交进行了限制

主要通过限制每分钟刷新和提交选座的次数（1分钟6次）

保证不会由于用户极端操作不断刷新导致的被封号问题。

通过计数器和wx提供的接口实现。



#### 7. 增加了刷新数据提示和信息加载成功提示

通过通知栏告知形成反馈，让用户对于数据加载情况心中有数

在选择好房间和时间后，等加载座位数据（位置 电源 窗户）完成后马上对用户进行提示。

